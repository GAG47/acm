# ç½‘ç»œæµ

## æœ€å¤§æµ

### FF

è¿™æ˜¯ä¸€ç§æ—¶é—´å¤æ‚åº¦ä¸º $O(fm)$ çš„ç®—æ³•ï¼Œ$f$ ä¸ºæœ€å¤§æµã€‚

~~~c++
int n, m, s, t; // sæ˜¯æºç‚¹ï¼Œtæ˜¯æ±‡ç‚¹
bool vis[MAXN];
int dfs(int p = s, int flow = INF)
{
    if (p == t)
        return flow; // åˆ°è¾¾ç»ˆç‚¹ï¼Œè¿”å›è¿™æ¡å¢å¹¿è·¯çš„æµé‡
    vis[p] = true;
    for (int eg = head[p]; eg; eg = edges[eg].next)
    {
        int to = edges[eg].to, vol = edges[eg].w, c;
        // è¿”å›çš„æ¡ä»¶æ˜¯æ®‹ä½™å®¹é‡å¤§äº0ã€æœªè®¿é—®è¿‡è¯¥ç‚¹ä¸”æ¥ä¸‹æ¥å¯ä»¥è¾¾åˆ°ç»ˆç‚¹ï¼ˆé€’å½’åœ°å®ç°ï¼‰
        // ä¼ é€’ä¸‹å»çš„æµé‡æ˜¯è¾¹çš„å®¹é‡ä¸å½“å‰æµé‡ä¸­çš„è¾ƒå°å€¼
        if (vol > 0 && !vis[to] && (c = dfs(to, min(vol, flow))) != -1)
        {
            edges[eg].w -= c;
            edges[eg ^ 1].w += c;
            // è¿™æ˜¯é“¾å¼å‰å‘æ˜Ÿå–åå‘è¾¹çš„ä¸€ç§ç®€æ˜“çš„æ–¹æ³•
            // å»ºå›¾æ—¶è¦æŠŠcntç½®ä¸º1ï¼Œä¸”è¦ä¿è¯åå‘è¾¹ç´§æ¥ç€æ­£å‘è¾¹å»ºç«‹
            return c;
        }
    }
    return -1; // æ— æ³•åˆ°è¾¾ç»ˆç‚¹
}
inline int FF()
{
    int ans = 0, c;
    while ((c = dfs()) != -1)
    {
        memset(vis, 0, sizeof(vis));
        ans += c;
    }
    return ans;
}
~~~



### EK

è¿™æ˜¯ä¸€ç§æ—¶é—´å¤æ‚åº¦ä¸Šé™ä¸º $O(nm^2)$ çš„ç®—æ³•ã€‚

~~~c++
...

struct Edge
{
    ll to,w,nex;
}edge[MAXM];
int head[MAXN],cnt=1;
void add(int from,int to,int w)
{
    edge[++cnt].to=to;
    edge[cnt].w=w;
    edge[cnt].nex=head[from];
    head[from]=cnt;
}

ll n,m,s,t,last[MAXN],flow[MAXN];
inline int bfs()
{
    memset(last,-1,sizeof(last));
    queue<int>que;
    que.push(s);
    flow[s]=INF;
    while(!que.empty())
    {
        int p=que.front();
        que.pop();
        if(p==t) //åˆ°è¾¾æ±‡ç‚¹ ç»“æŸæœç´¢
        {
            break;
        }
        for(int eg=head[p];eg;eg=edge[eg].nex)
        {
            ll to=edge[eg].to,val=edge[eg].w;
            if(val>0 && last[to]==-1) //æ®‹ä½™å®¹é‡å¤§äº0ä¸”æœªè®¿é—®è¿‡
            {
                last[to]=eg;
                flow[to]=min(flow[p],val);
                que.push(to);
            }
        }
    }
    return last[t]!=-1;
}
inline ll EK()
{
    ll maxflow=0;
    while(bfs())
    {
        maxflow+=flow[t];
        for(int i=t;i!=s;i=edge[last[i]^1].to)
        {
            edge[last[i]].w-=flow[t]; //ä¿è¯æ­£åè¾¹æ°å¥½å æ®å¥‡å¶æ•°
            edge[last[i]^1].w+=flow[t]; //å¹¶ä¸”ä¸ç”¨0 1 ï¼ˆ0ä¸ºè¾¹ç•Œç‚¹ï¼‰
        }
    }
    return maxflow;
}

void solve()
{
    cin>>n>>m>>s>>t;
    int u,v,w;
    for(int i=1;i<=m;++i)
    {
        cin>>u>>v>>w;
        add(u,v,w);
        add(v,u,0);
    }
    cout<<EK();
}
...
~~~

### Dinic

è¿™æ˜¯ä¸€ç§æ—¶é—´å¤æ‚åº¦ä¸Šé™ä¸º $O(n^2m)$ çš„ç®—æ³•ï¼Œåœ¨**ç¨ å¯†å›¾**ä¸­ï¼Œæ¯” $EK$ ç®—æ³•æœ‰æ›´å¥½çš„æ•ˆç‡ã€‚

~~~c++
struct Edge
{
    ll to,w,next;
}edge[MAXM];
ll head[MAXN],cnt=1;
void add(int from,int to,ll w)
{
    edge[++cnt].to=to;
    edge[cnt].w=w;
    edge[cnt].next=head[from];
    head[from]=cnt;
}

ll n,m,s,t,lv[MAXN],cur[MAXN]; //lvæ˜¯å±‚æ•° curæ˜¯å½“å‰å¼§ä¼˜åŒ–
inline bool bfs() //bfsè´Ÿè´£åˆ†å±‚
{
    memset(lv,-1,sizeof(lv));
    memcpy(cur,head,sizeof(head));
    lv[s]=0;
    queue<int>que;
    que.push(s);
    while(!que.empty())
    {
        int q=que.front();
        que.pop();
        for(int i=head[q];i;i=edge[i].next)
        {
            int to=edge[i].to,val=edge[i].w;
            if(val>0&&lv[to]==-1) //æœªæ›´æ–°è¿‡æ·±åº¦åˆ™æ›´æ–°
            {
                lv[to]=lv[q]+1,que.push(to);
            }
        }
    }
    return lv[t]!=-1;
}
ll dfs(int p=s,ll flow=INF)
{
    if(p==t) return flow;
    ll rmn=flow; //å‰©ä½™çš„æµé‡
    for(int i=cur[p];i&&rmn;i=edge[i].next) //æ²¡æœ‰å‰©ä½™æµé‡å°±é€€å‡º
    {
        cur[p]=i; //å½“å‰å¼§ä¼˜åŒ–
        ll to=edge[i].to,val=edge[i].w;
        if(val>0&&lv[to]==lv[p]+1) //åªä¼ å‘æ›´æ·±çš„å±‚
        {
            int c=dfs(to,min(val,rmn));
            rmn-=c; //å‰©ä½™æµé‡å‡å°‘
            edge[i].w-=c;
            edge[i^1].w+=c;
        }
    }
    if(rmn==flow) lv[p]=0; //å¦‚æœä¸€ç‚¹æ²¡æµå‡ºå»ï¼Œåœ¨è¿™ä¸ªdfså†…å°±æ²¡å¿…è¦å†è®¿é—®äº†
    return flow-rmn; //è¿”å›ä¼ é€’å‡ºå»çš„æµé‡å¤§å°
}
inline ll dinic()
{
    ll ans=0;
    while(bfs())
    {
        ans+=dfs();
    }
    return ans;
}
~~~

### ISAP

## è´¹ç”¨æµ

### EK+SPFA

~~~c++
int head[MAXN],cnt=1;
struct Edge
{
    int to,w,c,next;
}edge[MAXM*2];
inline void add(int from,int to,int w,int c)
{
    edge[++cnt].to=to;
    edge[cnt].w=w;
    edge[cnt].c=c;
    edge[cnt].next=head[from];
    head[from]=cnt;
}

int n,m,s,t,last[MAXN],flow[MAXN],inq[MAXN],dist[MAXN];
queue<int>que;
bool SPFA()
{
    while(!que.empty()) que.pop();
    memset(last,-1,sizeof(last));
    memset(inq,0,sizeof(inq));  //æ˜¯å¦åœ¨é˜Ÿåˆ—ä¸­
    memset(dist,127,sizeof(dist));  //è·ç¦»æºç‚¹çš„æœ€å°è·ç¦»
    flow[s]=INF;
    dist[s]=0;
    que.push(s);
    while(!que.empty())
    {
        int q=que.front();
        que.pop();
        inq[q]=0;
        for(int i=head[q];i;i=edge[i].next)
        {
            int to=edge[i].to,val=edge[i].w;
            if(val>0&&dist[to]>dist[q]+edge[i].c)
            {
                last[to]=i; //è®°å½•ä¸Šä¸€æ¡è¾¹
                flow[to]=min(flow[q],val); //æ›´æ–°ä¸‹ä¸€ä¸ªç‚¹çš„æµé‡
                dist[to]=dist[q]+edge[i].c;
                if(!inq[to])
                {
                    que.push(to);
                    inq[to]=1;
                }
            }
        }
    }
    return last[t]!=-1;
}
int maxflow,mincost;
inline void MCMF()
{
    while(SPFA())
    {
        maxflow+=flow[t];
        mincost+=dist[t]*flow[t];
        for(int i=t;i!=s;i=edge[last[i]^1].to) 
        {
            edge[last[i]].w-=flow[t];
            edge[last[i]^1].w+=flow[t];
        }   
    }
}
~~~

## äºŒè€…å–ä¸€æ¨¡å‹



## å¯¹å¶å›¾ä¼˜åŒ–æœ€å°å‰²

ç»“è®ºï¼š**æ±‚ä¸€ä¸ªç½‘ç»œæµçš„æœ€å°å‰²ç­‰ä»·äºæ±‚å…¶å¯¹å¶å›¾çš„æœ€çŸ­è·¯**
è¿™ä¸ªç»“è®ºååˆ†å…·è±¡ä¸”ç¬¦åˆç›´è§‰ï¼Œå¯¹å¶å›¾ä¸Šçš„æ²¡ä¸€ä¸ªç»è¿‡æ‰€æœ‰ç‚¹çš„ç®€å•è·¯å¾„ï¼Œå¿…ç„¶å°†åŸå›¾çš„èŠ‚ç‚¹åˆ†ä¸ºä¸¤ä¸ªé›†åˆã€‚è¿™å¯ä»¥ç”±å¯¹å¶å›¾çš„æ€§è´¨ä¸å®šä¹‰ç®€å•å¾—å‡ºã€‚è€Œä¸€èˆ¬åœ¨æ±‚è§£è¯¥é—®é¢˜æ—¶ï¼Œä¸ä¼šç›´æ¥æ±‚å¯¹å¶å›¾ä¸Šçš„æœ€çŸ­è·¯ï¼Œè€Œæ˜¯ä¼šæŠŠ**å›¾å¤–è¿é€šå—**æ‰€åŒ–çš„ç‚¹åˆ†å‰²ä¸ºèµ·ç‚¹ä¸ç»ˆç‚¹ï¼Œç„¶åå†è·‘æœ€çŸ­è·¯ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ—¶é—´å¤æ‚åº¦å¯ä»¥å°†ä¸€ä¸ªåŠçº§åˆ«ã€‚
![img](https://cdn.luogu.com.cn/upload/pic/63309.png)

[[ICPC-Beijing 2006] ç‹¼æŠ“å…”å­(å¯¹å¶å›¾æ±‚æœ€å°å‰²æ¿é¢˜)](https://www.luogu.com.cn/problem/P4001)



# ç½‘ç»œæµ24é¢˜



## 2ã€[é£è¡Œå‘˜é…å¯¹æ–¹æ¡ˆé—®é¢˜](https://www.luogu.com.cn/problem/P2756)

**é¢˜æ„**ï¼šç¬¬äºŒæ¬¡ä¸–ç•Œå¤§æˆ˜æœŸé—´ï¼Œè‹±å›½çš‡å®¶ç©ºå†›ä»æ²¦é™·å›½å¾å‹Ÿäº†å¤§é‡å¤–ç±é£è¡Œå‘˜ã€‚ç”±çš‡å®¶ç©ºå†›æ´¾å‡ºçš„æ¯ä¸€æ¶é£æœºéƒ½éœ€è¦é…å¤‡åœ¨èˆªè¡ŒæŠ€èƒ½å’Œè¯­è¨€ä¸Šèƒ½äº’ç›¸é…åˆçš„ä¸¤åé£è¡Œå‘˜ï¼Œå…¶ä¸­ä¸€åæ˜¯è‹±å›½é£è¡Œå‘˜ï¼Œå¦ä¸€åæ˜¯å¤–ç±é£è¡Œå‘˜ã€‚åœ¨ä¼—å¤šçš„é£è¡Œå‘˜ä¸­ï¼Œæ¯ä¸€åå¤–ç±é£è¡Œå‘˜éƒ½å¯ä»¥ä¸å…¶ä»–è‹¥å¹²åè‹±å›½é£è¡Œå‘˜å¾ˆå¥½åœ°é…åˆã€‚ä¸€å…±æœ‰ $n$ ä¸ªé£è¡Œå‘˜ï¼Œå…¶ä¸­æœ‰ $m$ ä¸ªå¤–ç±é£è¡Œå‘˜å’Œ $(n - m)$ ä¸ªè‹±å›½é£è¡Œå‘˜ï¼Œ**å¤–ç±é£è¡Œå‘˜ä» $1$ åˆ° $m$ ç¼–å·**ï¼Œ**è‹±å›½é£è¡Œå‘˜ä» $m + 1$ åˆ° $n$ ç¼–å·**ã€‚ å¯¹äºç»™å®šçš„å¤–ç±é£è¡Œå‘˜ä¸è‹±å›½é£è¡Œå‘˜çš„é…åˆæƒ…å†µï¼Œè¯•è®¾è®¡ä¸€ä¸ªç®—æ³•æ‰¾å‡ºæœ€ä½³é£è¡Œå‘˜é…å¯¹æ–¹æ¡ˆï¼Œä½¿çš‡å®¶ç©ºå†›ä¸€æ¬¡èƒ½æ´¾å‡ºæœ€å¤šçš„é£æœºã€‚

**é¢˜è§£**ï¼šç½‘ç»œæµä¸­æœ€åŸºç¡€çš„ä¸€ç±»é¢˜ç›®ï¼š**äºŒåˆ†å›¾æœ€å¤§åŒ¹é…**ã€‚è‹±å›½å’Œå¤–ç±åˆ†åˆ«ä½œä¸ºä¸€ä¸ªé›†åˆï¼Œä¸­é—´çš„è¾¹è¡¨ç¤ºå¯ä»¥å¾ˆå¥½é…åˆï¼Œæ±‚æœ€å¤§åŒ¹é…å³å¯ã€‚ç½‘ç»œæµçš„æ±‚æ³•ï¼šæ‰€æœ‰çš„è‹±å›½/å¤–ç±ä¸æºç‚¹å»ºç«‹æµé‡ä¸º $1$ çš„è¾¹ï¼Œå¦ä¸€ä¸ªåˆ™ä¸æ±‡ç‚¹å»ºç«‹æµé‡ä¸º $1$ çš„è¾¹ï¼Œæ±‚æœ€å¤§æµå³å¯ã€‚



## 3ã€[è½¯ä»¶è¡¥ä¸é—®é¢˜ ](https://www.luogu.com.cn/problem/P2761)

**é¢˜æ„**ï¼š
T å…¬å¸å‘ç°å…¶ç ”åˆ¶çš„ä¸€ä¸ªè½¯ä»¶ä¸­æœ‰ $n$ ä¸ªé”™è¯¯ï¼Œéšå³ä¸ºè¯¥è½¯ä»¶å‘æ”¾äº† $m$ ä¸ªè¡¥ä¸ç¨‹åºã€‚
æ¯ä¸€ä¸ªè¡¥ä¸ç¨‹åºéƒ½æœ‰å…¶ç‰¹å®šçš„é€‚ç”¨ç¯å¢ƒï¼ŒæŸä¸ªè¡¥ä¸åªæœ‰åœ¨è½¯ä»¶ä¸­åŒ…å«æŸäº›é”™è¯¯è€ŒåŒæ—¶åˆä¸åŒ…å«å¦ä¸€äº›é”™è¯¯æ—¶æ‰å¯ä»¥ä½¿ç”¨ã€‚ä¸€ä¸ªè¡¥ä¸åœ¨æ’é™¤æŸäº›é”™è¯¯çš„åŒæ—¶ï¼Œå¾€å¾€ä¼šåŠ å…¥å¦ä¸€äº›é”™è¯¯ã€‚
æ¢å¥è¯è¯´ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªè¡¥ä¸ $i$ï¼Œéƒ½æœ‰å››ä¸ªä¸ä¹‹ç›¸åº”çš„é›†åˆ $B1_i,B2_i,F1_i$ å’Œ $F2_i$ã€‚ä»…å½“è½¯ä»¶åŒ…å« $B1_i$ ä¸­çš„æ‰€æœ‰é”™è¯¯ï¼Œè€Œä¸åŒ…å« $B2_i$ ä¸­çš„ä»»ä½•é”™è¯¯æ—¶ï¼Œæ‰å¯ä»¥ä½¿ç”¨è¡¥ä¸ $i$ã€‚è¡¥ä¸ $i$ å°†ä¿®å¤è½¯ä»¶ä¸­çš„æŸäº›é”™è¯¯é›†åˆ $F1_i$ï¼Œè€ŒåŒæ—¶åŠ å…¥å¦ä¸€äº›é”™è¯¯ $F2_i$ã€‚å¦å¤–ï¼Œè¿è¡Œæ¯ä¸ªè¡¥ä¸éƒ½è€—è´¹ä¸€å®šçš„æ—¶é—´ã€‚
è¯•è®¾è®¡ä¸€ä¸ªç®—æ³•ï¼Œåˆ©ç”¨ T å…¬å¸æä¾›çš„ $m$ ä¸ªè¡¥ä¸ç¨‹åºå°†åŸè½¯ä»¶ä¿®å¤æˆä¸€ä¸ªæ²¡æœ‰é”™è¯¯çš„è½¯ä»¶ï¼Œå¹¶ä½¿ä¿®å¤åçš„è½¯ä»¶è€—æ—¶æœ€å°‘ã€‚å¯¹äºç»™å®šçš„ $n$ ä¸ªé”™è¯¯å’Œ $m$ ä¸ªè¡¥ä¸ç¨‹åºï¼Œæ‰¾åˆ°æ€»è€—æ—¶æœ€å°‘çš„è½¯ä»¶ä¿®å¤æ–¹æ¡ˆã€‚

**é¢˜è§£**ï¼š
è¿™é“é¢˜å…¶å®ä¸æ˜¯ç½‘ç»œæµã€‚(ğŸ˜¡)ï¼Œå°†é”™è¯¯çŠ¶æ€ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºï¼Œå†è½¬åŒ–ä¸ºåè¿›åˆ¶æ•°å­—æ¥è¡¨ç¤ºè¯¥çŠ¶æ€ï¼Œè¡¥ä¸ä½œä¸ºè¾¹æ¥è¿æ¥èŠ‚ç‚¹ï¼ˆä¾é  **|ï¼Œ&ï¼Œ^** ç­‰ä½è¿ç®—æ¥åˆ¤æ–­ä¸æ“ä½œï¼‰ï¼Œè·‘æœ€çŸ­è·¯å³å¯ã€‚



## 4ã€[è´Ÿè½½å¹³è¡¡é—®é¢˜](https://www.luogu.com.cn/problem/P4016)

**é¢˜æ„**ï¼š
$G$ å…¬å¸æœ‰ $n$ ä¸ªæ²¿é“è·¯è¿è¾“çº¿ç¯å½¢æ’åˆ—çš„ä»“åº“ï¼Œæ¯ä¸ªä»“åº“å­˜å‚¨çš„è´§ç‰©æ•°é‡ä¸ç­‰ã€‚å¦‚ä½•ç”¨æœ€å°‘æ¬è¿é‡å¯ä»¥ä½¿ $n$ ä¸ªä»“åº“çš„åº“å­˜æ•°é‡ç›¸åŒã€‚æ¬è¿è´§ç‰©æ—¶ï¼Œåªèƒ½åœ¨ç›¸é‚»çš„ä»“åº“ä¹‹é—´æ¬è¿ã€‚

**é¢˜è§£**ï¼š
å…ˆå¯¹æ‰€æœ‰ä»“åº“çš„è´§ç‰©æ•°é‡æ±‚å’Œï¼Œæ±‚å‡ºä»“åº“æœ€ååº”å½“ç”±çš„åº“å­˜æ•°é‡ã€‚
1ã€æ‰€æœ‰ä»“åº“ä¸æºç‚¹å»ºç«‹æµé‡ä¸º**åº“å­˜æ•°é‡**ï¼Œæƒå€¼ä¸º $0$ çš„è¾¹ã€‚
2ã€æ‰€æœ‰ä»“åº“ä¸æ±‡ç‚¹å»ºç«‹æµé‡ä¸º**å¹³å‡åº“å­˜æ•°é‡**ï¼Œæƒå€¼ä¸º $0$ çš„è¾¹ã€‚
3ã€ç›¸é‚»ä»“åº“ä¹‹é—´å»ºç«‹æƒå€¼ä¸º $INF$ ï¼Œæƒå€¼ä¸º $1$ çš„è¾¹ã€‚
æ±‚è´¹ç”¨æµçš„è´¹ç”¨å³å¯ã€‚



## 5ã€[è¿è¾“é—®é¢˜](https://www.luogu.com.cn/problem/P4015)

**é¢˜æ„**ï¼š

$W$ å…¬å¸æœ‰ $m$ ä¸ªä»“åº“å’Œ $n$ ä¸ªé›¶å”®å•†åº—ã€‚ç¬¬ $i$ ä¸ªä»“åº“æœ‰ $a_i$ ä¸ªå•ä½çš„è´§ç‰©ï¼›ç¬¬ $j$ ä¸ªé›¶å”®å•†åº—éœ€è¦ $b_j$ ä¸ªå•ä½çš„è´§ç‰©ã€‚è´§ç‰©ä¾›éœ€å¹³è¡¡ï¼Œå³$\sum\limits_{i=1}^{m}a_i=\sum\limits_{j=1}^{n}b_j$ã€‚
ä»ç¬¬ $i$ ä¸ªä»“åº“è¿é€æ¯å•ä½è´§ç‰©åˆ°ç¬¬ $j$ ä¸ªé›¶å”®å•†åº—çš„è´¹ç”¨ä¸º $c_{ij}$ ã€‚
è¯•è®¾è®¡ä¸€ä¸ªå°†ä»“åº“ä¸­æ‰€æœ‰è´§ç‰©è¿é€åˆ°é›¶å”®å•†åº—çš„è¿è¾“æ–¹æ¡ˆï¼Œä½¿æ€»è¿è¾“è´¹ç”¨æœ€å°‘ã€‚

**é¢˜è§£**ï¼š

ç½‘ç»œæµåˆä¸€ç»å…¸æ¨¡å‹ï¼š**äºŒåˆ†å›¾æœ€å°æƒæœ€å¤§åŒ¹é…**ã€‚å°†ä»“åº“å½“ä½œä¸€é›†åˆï¼Œé›¶å”®åº—å½“ä½œå¦ä¸€é›†åˆï¼Œè¿è´§ä½œä¸ºè¾¹ï¼Œè¿è´§è´¹ç”¨ä½œç”¨è¾¹çš„æƒå€¼ã€‚æ´¾ä¸€è¾¹è´¹ç”¨æµå³å¯ã€‚



## 5ã€[(åœ†æ¡Œé—®é¢˜)](https://www.luogu.com.cn/problem/P3254)

**é¢˜æ„**ï¼š
æœ‰æ¥è‡ª $m$ ä¸ªä¸åŒå•ä½çš„ä»£è¡¨å‚åŠ ä¸€æ¬¡å›½é™…ä¼šè®®ã€‚ç¬¬ $i$ ä¸ªå•ä½æ´¾å‡ºäº† $r_i$ ä¸ªä»£è¡¨ã€‚
ä¼šè®®çš„é¤å…å…±æœ‰ $n$ å¼ é¤æ¡Œï¼Œç¬¬ $i$ å¼ é¤æ¡Œå¯å®¹çº³ $c_i$ ä¸ªä»£è¡¨å°±é¤ã€‚
ä¸ºäº†ä½¿ä»£è¡¨ä»¬å……åˆ†äº¤æµï¼Œå¸Œæœ›ä»åŒä¸€ä¸ªå•ä½æ¥çš„ä»£è¡¨ä¸åœ¨åŒä¸€ä¸ªé¤æ¡Œå°±é¤ã€‚è¯·ç»™å‡ºä¸€ä¸ªæ»¡è¶³è¦æ±‚çš„ä»£è¡¨å°±é¤æ–¹æ¡ˆã€‚

**é¢˜è§£**ï¼š
ä¾æ—§æ˜¯**äºŒåˆ†å›¾æ±‚æœ€å¤§åŒ¹é…**ã€‚å•ä½å’Œé¤æ¡Œåˆ†åˆ«ä½œä¸ºä¸€ä¸ªé›†åˆï¼Œå•ä½ä¸æºç‚¹å»ºç«‹æµé‡ä¸º $r_i$ çš„è¾¹ï¼Œé¤æ¡Œä¸æ±‡ç‚¹å»ºç«‹æµé‡ä¸º $c_i$ çš„è¾¹ï¼Œæ¯ä¸ªå•ä½å‘æ¯ä¸ªé¤æ¡ŒæŒ‡å‡ºä¸€æ¡æµé‡ä¸º $1$ çš„è¾¹ï¼Œè·‘ä¸€éæœ€å¤§æµã€‚å¦‚æœæœ€å¤§æµä¸ç­‰äºä»£è¡¨æ€»æ•°ç›®åˆ™æ— æ–¹æ¡ˆï¼›åä¹‹åˆ™æœ‰ï¼Œæ­¤æ—¶éå†ä¸¤ä¸ªé›†åˆå†…çš„æ­£å‘è¾¹ï¼Œå¦‚æœæµé‡ä¸º $0$ è¯´æ˜è¯¥è¾¹å·²ç»è¢«è·‘è¿‡ï¼Œè®°å½•ä¸¤ä¸ªç«¯ç‚¹ï¼Œå¦‚æœåˆ†åˆ«ä¸ºå•ä½å’Œé¤æ¡Œï¼Œåˆ™è®°å½•ç­”æ¡ˆã€‚



## 6ã€[è¯•é¢˜åº“é—®é¢˜](https://www.luogu.com.cn/problem/P2763)

**é¢˜æ„**ï¼š
å‡è®¾ä¸€ä¸ªè¯•é¢˜åº“ä¸­æœ‰ $n$ é“è¯•é¢˜ã€‚æ¯é“è¯•é¢˜éƒ½æ ‡æ˜äº†æ‰€å±ç±»åˆ«ã€‚åŒä¸€é“é¢˜å¯èƒ½æœ‰å¤šä¸ªç±»åˆ«å±æ€§ã€‚ç°è¦ä»é¢˜åº“ä¸­æŠ½å– $m$ é“é¢˜ç»„æˆè¯•å·ã€‚å¹¶è¦æ±‚è¯•å·åŒ…å«æŒ‡å®šç±»å‹çš„è¯•é¢˜ã€‚è¯•è®¾è®¡ä¸€ä¸ªæ»¡è¶³è¦æ±‚çš„ç»„å·ç®—æ³•ã€‚

**é¢˜è§£**ï¼š
äºŒåˆ†å›¾åŒ¹é…é—®é¢˜ã€‚é¢˜ç›®å’Œè¯•å·åˆ†åˆ«ä½œä¸ºä¸€ä¸ªé›†åˆï¼Œé¢˜ç›®ä¸æºç‚¹è¿æ¥æµé‡ä¸º $1$ çš„è¾¹ï¼Œç±»å‹ä¸æ±‡ç‚¹è¿æ¥æµé‡ä¸ºé¢˜ç›®æ•°é‡çš„è¾¹ï¼Œåœ¨é€šè¿‡é¢˜çš„å±æ€§è¿è¾¹ï¼Œè·‘æœ€å¤§æµå³å¯ã€‚å¦‚æœæœ€å¤§æµä¸ç­‰äºä»£è¡¨æ€»æ•°ç›®åˆ™æ— æ–¹æ¡ˆï¼›åä¹‹åˆ™æœ‰ï¼Œæ­¤æ—¶éå†ä¸¤ä¸ªé›†åˆå†…çš„æ­£å‘è¾¹ï¼Œå¦‚æœæµé‡ä¸º $0$ è¯´æ˜è¯¥è¾¹å·²ç»è¢«è·‘è¿‡ï¼Œè®°å½•ä¸¤ä¸ªç«¯ç‚¹ï¼Œå¦‚æœåˆ†åˆ«ä¸ºé¢˜ç›®å’Œè¯•å·ï¼Œåˆ™è®°å½•ç­”æ¡ˆã€‚ï¼ˆè¿™é“é¢˜å’Œä¸Šä¸€é“åŸºæœ¬ä¸€æ¨¡ä¸€æ ·ï¼‰ã€‚



## 7ã€[éª‘å£«å…±å­˜é—®é¢˜](https://www.luogu.com.cn/problem/P3355)

**é¢˜æ„**ï¼š

åœ¨ä¸€ä¸ª $n \times n$ ä¸ªæ–¹æ ¼çš„å›½é™…è±¡æ£‹æ£‹ç›˜ä¸Šï¼Œé©¬ï¼ˆéª‘å£«ï¼‰å¯ä»¥æ”»å‡»çš„æ£‹ç›˜æ–¹æ ¼å¦‚å›¾æ‰€ç¤ºã€‚æ£‹ç›˜ä¸ŠæŸäº›æ–¹æ ¼è®¾ç½®äº†éšœç¢ï¼Œéª‘å£«ä¸å¾—è¿›å…¥ã€‚

![](https://cdn.luogu.com.cn/upload/pic/2669.png)

å¯¹äºç»™å®šçš„ $n \times n$ ä¸ªæ–¹æ ¼çš„å›½é™…è±¡æ£‹æ£‹ç›˜å’Œéšœç¢æ ‡å¿—ï¼Œè®¡ç®—æ£‹ç›˜ä¸Šæœ€å¤šå¯ä»¥æ”¾ç½®å¤šå°‘ä¸ªéª‘å£«ï¼Œä½¿å¾—å®ƒä»¬å½¼æ­¤äº’ä¸æ”»å‡»ã€‚

**é¢˜è§£**ï¼š
åœ¨ä¸è€ƒè™‘éšœç¢çš„æƒ…å†µä¸‹ï¼Œå®¹æ˜“æƒ³åˆ°å¯¹æ‰€æœ‰ä¸€æ¬¡å¯è¾¾çš„æ ¼å­å»ºè¾¹ï¼Œè½¬åŒ–ä¸ºæ±‚å›¾çš„**æœ€å¤§ç‹¬ç«‹é›†**ï¼›ç°è€ƒè™‘éšœç¢ï¼Œåªéœ€è¦ä¸å°†éšœç¢æ‰€åœ¨èŠ‚ç‚¹æ”¾å…¥å›¾ä¸­å³å¯ã€‚åˆå®¹æ˜“å‘ç°ï¼Œå¦‚æœæŠŠæ£‹ç›˜ä¸Šçš„æ ¼å­åˆ†ä¸ºå¥‡å¶ä¸¤ç§ç±»å‹ï¼ˆå›¾ä¸­çº¢é»„ï¼‰ï¼Œåˆ™é©¬æ¯æ¬¡ç§»åŠ¨éƒ½ä¼šæ”¹å˜è‡ªå·±æ ¼å­æ‰€åœ¨çš„å¥‡å¶æ€§è´¨ï¼Œå› è€Œè€ƒè™‘ä½¿ç”¨**äºŒåˆ†å›¾**ï¼Œå°†å¥‡å¶æ ¼å­åˆ†åˆ«ä½œä¸ºä¸€ä¸ªé›†åˆï¼Œé‚£ä¹ˆæœ‰æœ€å¤§ç‹¬ç«‹é›†=èŠ‚ç‚¹æ•°-æœ€å°ç‚¹è¦†ç›–ï¼Œæ ¹æ®**åº·æ‹“å®šç†**ï¼Œæœ‰æœ€å°ç‚¹è¦†ç›–=æœ€å¤§åŒ¹é…ï¼Œå› è€Œè¯¥é¢˜å¯ä»¥è½¬åŒ–ä¸ºæ±‚**äºŒåˆ†å›¾æœ€å¤§åŒ¹é…**ï¼Œæ±‚å‡ºæœ€å¤§æµåï¼Œç­”æ¡ˆå³ä¸º $ans=n*n-m-maxflow$ã€‚

æˆ–è€…ç”¨**æœ€å°å‰²**çš„è§’åº¦ç†è§£ä¹Ÿå¯ï¼Œæˆ‘ä»¬ç”¨æ‰€æœ‰å¯æ”¾ç½®é©¬çš„èŠ‚ç‚¹å»ºè¾¹ï¼Œä¾æ—§æŒ‰ç…§å¥‡å¶æ ¼å­å»ºç«‹äºŒåˆ†å›¾ï¼š
1ã€æ‰€æœ‰å¥‡æ ¼å­ä¸æºç‚¹å»ºç«‹æµé‡ä¸º $1$ çš„è¾¹
2ã€æ‰€æœ‰å¶æ ¼å­ä¸æ±‡ç‚¹å»ºç«‹æµé‡ä¸º $1$ çš„è¾¹
3ã€å¯äº’ç›¸åˆ°è¾¾çš„å¥‡å¶æ ¼å­å»ºç«‹æµé‡ä¸º $INF$ çš„è¾¹
å› ä¸ºæœ€å°å‰²=æœ€å¤§æµï¼Œæ­¤æ—¶æ±‚å‡ºæœ€å¤§æµå³å¯ã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºæœ€å°å‰²æ˜¯**å‰²å»è¾¹ä½¿å¾—æºç‚¹æ±‡ç‚¹åˆ†ä¸ºä¸¤ä¸ªäº’ç›¸ä¸å¯è¾¾çš„é›†åˆçš„æœ€å°ä»£ä»·**ï¼Œè€Œè¿™ä¸ªå»ºå›¾æ–¹å¼ä¸­å¥‡å¶æ ¼å­ä¹‹é—´çš„è¾¹çš„æƒå€¼éƒ½æ˜¯æ— ç©·ï¼Œä¸å¯èƒ½å‰²å»ï¼Œå› æ­¤åªèƒ½å‰²å»è¾¹ç±»å‹ $1$ å’Œç±»å‹ $2$ ï¼Œå‰²å»æŸä¸ªèŠ‚ç‚¹è¿æ¥çš„è¾¹è¡¨ç¤ºä¸å–è¯¥èŠ‚ç‚¹ï¼Œåˆ™å‰©ä¸‹çš„èŠ‚ç‚¹ä¿è¯ä¸å­˜åœ¨å†²çªï¼Œä¸”ç”±äºæœ€å°å‰²æ˜¯æœ€å°ä»£ä»·ï¼Œå› æ­¤å‰©ä¸‹çš„èŠ‚ç‚¹å³æ˜¯ç¬¦åˆæ¡ä»¶çš„æœ€å¤§å€¼ã€‚ï¼ˆå…¶å®æœ€å¤§åŒ¹é…å°±æ˜¯ç”¨æœ€å°å‰²çš„æ€æƒ³ç½¢ğŸ¤”ï¼‰



## 9ã€[æ–¹æ ¼å–æ•°é—®é¢˜](https://www.luogu.com.cn/problem/P2774)

**é¢˜æ„**ï¼š
æœ‰ä¸€ä¸ª $m$ è¡Œ $n$ åˆ—çš„æ–¹æ ¼å›¾ï¼Œæ¯ä¸ªæ–¹æ ¼ä¸­éƒ½æœ‰ä¸€ä¸ªæ­£æ•´æ•°ã€‚ç°è¦ä»æ–¹æ ¼ä¸­å–æ•°ï¼Œä½¿ä»»æ„ä¸¤ä¸ªæ•°æ‰€åœ¨æ–¹æ ¼æ²¡æœ‰å…¬å…±è¾¹ï¼Œä¸”å–å‡ºçš„æ•°çš„æ€»å’Œæœ€å¤§ï¼Œè¯·æ±‚å‡ºæœ€å¤§çš„å’Œã€‚

**é¢˜è§£**ï¼š
ç›¸é‚»æ ¼å­ä¸èƒ½åŒæ—¶å–ï¼Œå®¹æ˜“æƒ³åˆ°å¯¹ç›¸é‚»æ ¼å­å»ºè¾¹ï¼Œç„¶åæ±‚æ€»æƒå€¼å’Œå‡å»æœ€å°å‰²å³å¯ã€‚



## 10ã€[æ±½è½¦åŠ æ²¹è¡Œé©¶é—®é¢˜](https://www.luogu.com.cn/problem/P4009)

**é¢˜æ„**ï¼šç»™å®šä¸€ä¸ª $N \times N$ çš„æ–¹å½¢ç½‘æ ¼ï¼Œè®¾å…¶å·¦ä¸Šè§’ä¸ºèµ·ç‚¹â—ï¼Œåæ ‡$(1,1)$ï¼Œ$X$ è½´å‘å³ä¸ºæ­£ï¼Œ $Y$ è½´å‘ä¸‹ä¸ºæ­£ï¼Œæ¯ä¸ªæ–¹æ ¼è¾¹é•¿ä¸º $1$ ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚



 ![](https://cdn.luogu.com.cn/upload/pic/12156.png) 

ä¸€è¾†æ±½è½¦ä»èµ·ç‚¹â—å‡ºå‘é©¶å‘å³ä¸‹è§’ç»ˆç‚¹â–²ï¼Œå…¶åæ ‡ä¸º $(N,N)$ã€‚


åœ¨è‹¥å¹²ä¸ªç½‘æ ¼äº¤å‰ç‚¹å¤„ï¼Œè®¾ç½®äº†æ²¹åº“ï¼Œå¯ä¾›æ±½è½¦åœ¨è¡Œé©¶é€”ä¸­åŠ æ²¹ã€‚æ±½è½¦åœ¨è¡Œé©¶è¿‡ç¨‹ä¸­åº”éµå®ˆå¦‚ä¸‹è§„åˆ™:


1. æ±½è½¦åªèƒ½æ²¿ç½‘æ ¼è¾¹è¡Œé©¶ï¼Œè£…æ»¡æ²¹åèƒ½è¡Œé©¶ $K$ æ¡ç½‘æ ¼è¾¹ã€‚å‡ºå‘æ—¶æ±½è½¦å·²è£…æ»¡æ²¹ï¼Œåœ¨èµ·ç‚¹ä¸ç»ˆç‚¹å¤„ä¸è®¾æ²¹åº“ã€‚

2. æ±½è½¦ç»è¿‡ä¸€æ¡ç½‘æ ¼è¾¹æ—¶ï¼Œè‹¥å…¶ $X$ åæ ‡æˆ– $Y$ åæ ‡å‡å°ï¼Œåˆ™åº”ä»˜è´¹ç”¨ $B$ ï¼Œå¦åˆ™å…ä»˜è´¹ç”¨ã€‚

3. æ±½è½¦åœ¨è¡Œé©¶è¿‡ç¨‹ä¸­é‡æ²¹åº“åˆ™åº”åŠ æ»¡æ²¹å¹¶ä»˜åŠ æ²¹è´¹ç”¨ $A$ã€‚

4. åœ¨éœ€è¦æ—¶å¯åœ¨ç½‘æ ¼ç‚¹å¤„å¢è®¾æ²¹åº“ï¼Œå¹¶ä»˜å¢è®¾æ²¹åº“è´¹ç”¨ $C$(ä¸å«åŠ æ²¹è´¹ç”¨$A$ )ã€‚

5. $N,K,A,B,C$ å‡ä¸ºæ­£æ•´æ•°ï¼Œ ä¸”æ»¡è¶³çº¦æŸ: $2\leq N\leq 100,2 \leq K \leq 10$ã€‚

è®¾è®¡ä¸€ä¸ªç®—æ³•ï¼Œæ±‚å‡ºæ±½è½¦ä»èµ·ç‚¹å‡ºå‘åˆ°è¾¾ç»ˆç‚¹æ‰€ä»˜çš„æœ€å°è´¹ç”¨ã€‚

**é¢˜è§£**ï¼š

å®¹æ˜“æƒ³åˆ°å°†åæ ‡ $Xã€Y$ å’Œæ²¹é‡ $K$ ä½œä¸ºä¸€ä¸ªçŠ¶æ€çš„ä¸‰ä¸ªå†³å®šæ€§ä¿¡æ¯ï¼Œæ•…ä½¿ç”¨åˆ†å±‚å›¾æ¥è¡¨ç¤ºè¿™ä¸‰ä¸ªçŠ¶æ€çš„äº’ç›¸è½¬æ¢ã€‚è¿™æ ·åªéœ€è¦åœ¨åˆ†å±‚å›¾ä¸Šè·‘ä¸€ç§ç®—æ³•å¯ä»¥æ±‚å‡ºä»èµ·ç‚¹åˆ°ç»ˆç‚¹çš„æœ€å°è´¹ç”¨å³å¯ï¼Œå®¹æ˜“æƒ³åˆ°ä½¿ç”¨æœ€çŸ­è·¯ç®—æ³•ï¼Œè¾¹çš„æƒå€¼å³æ˜¯èŠ±è´¹çš„è´¹ç”¨ã€‚å»ºè¾¹æ–¹å¼ï¼ˆå‡è®¾ç°åœ¨ä½äº $(x,y,k)$ï¼‰ï¼š
1.å‘ $(x+1,y,k-1)$ ä¸ $(x,y+1,k-1)$ åˆ†åˆ«å»ºç«‹æƒå€¼ä¸º $0$ çš„è¾¹ï¼Œå‘$(x-1,y,k-1)$ ä¸ $(x,y-1,k-1)$å»ºç«‹æƒå€¼ä¸º $B$ çš„è¾¹ï¼Œæ³¨æ„ç‰¹åˆ¤ $k=0$ çš„æƒ…å†µå³å¯ã€‚ã€‚
2.å¦‚æœ $(x,y)$ æœ‰åŠ æ²¹ç«™ï¼Œåˆ™å‘ $(x,y,K)$ å»ºç«‹ä¸€æ¡æƒå€¼ä¸º $A$ çš„è¾¹ã€‚
3.å‘ $(x,y,K)$ å»ºç«‹ä¸€æ¡æƒå€¼ä¸º $A+C$ çš„è¾¹ã€‚
4.æºç‚¹ä¸º $(1,1,K)$ ï¼Œç»ˆç‚¹ä¸º $(n,m,\sum_{k=0}^{K}k)$
è™½ç„¶è¯´æ˜¯ç”¨æœ€çŸ­è·¯è§£çš„ï¼Œä½†æ˜¯è·‘è´¹ç”¨æµä¹Ÿæ˜¯å¯ä»¥çš„ã€‚



## 11ã€[å®¶å›­ / æ˜Ÿé™…è½¬ç§»é—®é¢˜](https://www.luogu.com.cn/problem/P2754)

**é¢˜æ„**ï¼š

> **ç”±äºäººç±»å¯¹è‡ªç„¶èµ„æºçš„æ¶ˆè€—ï¼Œäººä»¬æ„è¯†åˆ°å¤§çº¦åœ¨ 2300 å¹´ä¹‹åï¼Œåœ°çƒå°±ä¸èƒ½å†å±…ä½äº†ã€‚äºæ˜¯åœ¨æœˆçƒä¸Šå»ºç«‹äº†æ–°çš„ç»¿åœ°ï¼Œä»¥ä¾¿åœ¨éœ€è¦æ—¶ç§»æ°‘ã€‚ä»¤äººæ„æƒ³ä¸åˆ°çš„æ˜¯ï¼Œ2177 å¹´å†¬ç”±äºæœªçŸ¥çš„åŸå› ï¼Œåœ°çƒç¯å¢ƒå‘ç”Ÿäº†è¿é”å´©æºƒï¼Œäººç±»å¿…é¡»åœ¨æœ€çŸ­çš„æ—¶é—´å†…è¿å¾€æœˆçƒã€‚**
> **ç°æœ‰ $n$ ä¸ªå¤ªç©ºç«™ä½äºåœ°çƒä¸æœˆçƒä¹‹é—´ï¼Œä¸”æœ‰ $m$ è‰˜å…¬å…±äº¤é€šå¤ªç©ºèˆ¹åœ¨å…¶é—´æ¥å›ç©¿æ¢­ã€‚æ¯ä¸ªå¤ªç©ºç«™å¯å®¹çº³æ— é™å¤šçš„äººï¼Œè€Œå¤ªç©ºèˆ¹çš„å®¹é‡æ˜¯æœ‰é™çš„ï¼Œç¬¬ $i$ è‰˜å¤ªç©ºèˆ¹åªå¯å®¹çº³  $h_i$ ä¸ªäººã€‚æ¯è‰˜å¤ªç©ºèˆ¹å°†å‘¨æœŸæ€§åœ°åœé ä¸€ç³»åˆ—çš„å¤ªç©ºç«™ï¼Œä¾‹å¦‚ $(1,3,4)$ è¡¨ç¤ºè¯¥å¤ªç©ºèˆ¹å°†å‘¨æœŸæ€§åœ°åœé å¤ªç©ºç«™ $134134134\dots$ã€‚æ¯ä¸€è‰˜å¤ªç©ºèˆ¹ä»ä¸€ä¸ªå¤ªç©ºç«™é©¶å¾€ä»»ä¸€å¤ªç©ºç«™è€—æ—¶å‡ä¸º $1$ã€‚äººä»¬åªèƒ½åœ¨å¤ªç©ºèˆ¹åœé å¤ªç©ºç«™(æˆ–æœˆçƒã€åœ°çƒ)æ—¶ä¸Šã€ä¸‹èˆ¹ã€‚**
> **åˆå§‹æ—¶æ‰€æœ‰äººå…¨åœ¨åœ°çƒä¸Šï¼Œå¤ªç©ºèˆ¹å…¨åœ¨åˆå§‹ç«™ã€‚è¯•è®¾è®¡ä¸€ä¸ªç®—æ³•ï¼Œæ‰¾å‡ºè®©æ‰€æœ‰äººå°½å¿«åœ°å…¨éƒ¨è½¬ç§»åˆ°æœˆçƒä¸Šçš„è¿è¾“æ–¹æ¡ˆã€‚**

**é¢˜è§£**ï¼š
å› ä¸ºé£èˆ¹åœ¨ä¸åŒçš„æ—¶é—´åœ¨ä¸åŒçš„èŠ‚ç‚¹ï¼ŒåŒä¸€ä¸ªèŠ‚ç‚¹åœ¨ä¸åŒçš„æ—¶é—´æœ‰ä¸åŒçš„æ€§è´¨ï¼Œå®¹æ˜“æƒ³åˆ°å°†æ‰€åœ¨çš„ä½ç½® $x$ å’Œç°åœ¨çš„æ—¶é—´ $t$ ä½œä¸ºä¸€ä¸ªçŠ¶æ€çš„ä¸¤ä¸ªå†³å®šæ€§ä¿¡æ¯ï¼Œé‚£ä¹ˆè€ƒè™‘ä½¿ç”¨åˆ†å±‚å›¾ï¼ŒæŒ‰ç…§å¦‚ä¸‹æ–¹å¼å»ºè¾¹ï¼ˆå‡è®¾ä½äºç©ºé—´ç«™ $x$ ï¼Œæ—¶é—´ä¸º $t$ï¼‰:
1.ä¸ $(x,t+1)$ å»ºç«‹æµé‡ä¸º $INF$ çš„è¾¹
2.ä¸ $(æ­¤æ—¶åœ¨xçš„é£èˆ¹çš„ä¸‹ä¸€ç«™y,t+1)$å»ºç«‹æµé‡ä¸ºé£èˆ¹è·è½½çš„è¾¹
3.ï¼ˆåœ°çƒï¼Œ0ï¼‰ä¸æºç‚¹å»ºè¾¹ï¼Œï¼ˆæœˆçƒï¼Œanyï¼‰ä¸æ±‡ç‚¹å»ºè¾¹
ä½†æ˜¯ï¼Œç°åœ¨é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œæ—¶é—´ $t$ çš„ä¸Šé™ä¹Ÿå°±æ˜¯è¦æ±‚å§çš„ç­”æ¡ˆï¼Œæ˜¯ä¸ç¡®å®šçš„ï¼Œé‚£ä¹ˆè¦ç”¨ä»€ä¹ˆç®—æ³•å»åˆ©ç”¨è¿™å›¾å‘¢ï¼Ÿè€ƒè™‘ä¸æ–­å¢å¤§ $t$ï¼Œæ¯æ¬¡åŠ å…¥å¯¹åº”çš„è¾¹ï¼Œå¹¶è·‘ä¸€éæ®‹é‡ç½‘ç»œæµï¼Œç”¨ $dinic$ ç®—æ³•å»è·‘ï¼Œæ—¶é—´å¤æ‚åº¦ä¸Šä¹Ÿä¸ç®—å¾ˆå·®ã€‚(æ³¨æ„ï¼Œ$dinic$ ç®—æ³•è·‘ç¨€ç–å›¾çš„æ®‹é‡ç½‘ç»œæœ‰å¾ˆå¥½çš„å¤æ‚åº¦ï¼Œä½†æ˜¯å¯èƒ½ä¼šå¯¼è‡´å‡ºç°è´Ÿç¯ï¼Œæ‰€ä»¥éœ€è¦é¿å…å‡ºç°æ–°å»ºçš„è¾¹æŠŠ)



## 12ã€[å¤ªç©ºé£è¡Œè®¡åˆ’é—®é¢˜](https://www.luogu.com.cn/problem/P2762)

> **W æ•™æˆæ­£åœ¨ä¸ºå›½å®¶èˆªå¤©ä¸­å¿ƒè®¡åˆ’ä¸€ç³»åˆ—çš„å¤ªç©ºé£è¡Œã€‚æ¯æ¬¡å¤ªç©ºé£è¡Œå¯è¿›è¡Œä¸€ç³»åˆ—å•†ä¸šæ€§å®éªŒè€Œè·å–åˆ©æ¶¦ã€‚ç°å·²ç¡®å®šäº†ä¸€ä¸ªå¯ä¾›é€‰æ‹©çš„å®éªŒé›†åˆ $ E = \{ E_1, E_2, \cdots, E_m \} $ï¼Œå’Œè¿›è¡Œè¿™äº›å®éªŒéœ€è¦ä½¿ç”¨çš„å…¨éƒ¨ä»ªå™¨çš„é›†åˆ $ I = \{ I_1, I_2, \cdots, I_n \} $ã€‚å®éªŒ $ E_j $ éœ€è¦ç”¨åˆ°çš„ä»ªå™¨æ˜¯ $ I $ çš„å­é›† $ R_j \subseteq I $ã€‚**
> **é…ç½®ä»ªå™¨ $ I_k $ çš„è´¹ç”¨ä¸º $ c_k $ ç¾å…ƒã€‚å®éªŒ $ E_j $ çš„èµåŠ©å•†å·²åŒæ„ä¸ºè¯¥å®éªŒç»“æœæ”¯ä»˜ $ p_j $ ç¾å…ƒã€‚W æ•™æˆçš„ä»»åŠ¡æ˜¯æ‰¾å‡ºä¸€ä¸ªæœ‰æ•ˆç®—æ³•ï¼Œç¡®å®šåœ¨ä¸€æ¬¡å¤ªç©ºé£è¡Œä¸­è¦è¿›è¡Œå“ªäº›å®éªŒå¹¶å› æ­¤è€Œé…ç½®å“ªäº›ä»ªå™¨æ‰èƒ½ä½¿å¤ªç©ºé£è¡Œçš„å‡€æ”¶ç›Šæœ€å¤§ã€‚è¿™é‡Œå‡€æ”¶ç›Šæ˜¯æŒ‡è¿›è¡Œå®éªŒæ‰€è·å¾—çš„å…¨éƒ¨æ”¶å…¥ä¸é…ç½®ä»ªå™¨çš„å…¨éƒ¨è´¹ç”¨çš„å·®é¢ã€‚**
> **å¯¹äºç»™å®šçš„å®éªŒå’Œä»ªå™¨é…ç½®æƒ…å†µï¼Œç¼–ç¨‹æ‰¾å‡ºå‡€æ”¶ç›Šæœ€å¤§çš„è¯•éªŒè®¡åˆ’ã€‚**

è¿™é“é¢˜æ˜¯**æœ€å°å‰²**çš„ç»å…¸æ¨¡å‹ä¹‹ä¸€ï¼š**æœ€å¤§æƒå€¼é—­åˆå›¾**ï¼Œå³ç»™å®šä¸€å¼ æœ‰å‘å›¾ï¼Œæ¯ä¸ªç‚¹éƒ½æœ‰ä¸€ä¸ªæƒå€¼ï¼ˆå¯ä»¥ä¸ºæ­£æˆ–è´Ÿæˆ– ![0](data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7))ï¼Œä½ éœ€è¦é€‰æ‹©ä¸€ä¸ªæƒå€¼å’Œæœ€å¤§çš„å­å›¾ï¼Œä½¿å¾—å­å›¾ä¸­æ¯ä¸ªç‚¹çš„åç»§éƒ½åœ¨å­å›¾ä¸­ã€‚
è¯¥æ¨¡å‹çš„è§£å†³æ–¹æ³•ä¸ºï¼šå¯¹äºæ­£æ•°æƒå€¼èŠ‚ç‚¹ï¼Œå°†å…¶ä¸æºç‚¹è¿æ¥**æµé‡ä¸ºæƒå€¼çš„è¾¹**ï¼›å¯¹äºè´Ÿæ•°æƒå€¼èŠ‚ç‚¹ï¼Œå°†å…¶ä¸æ±‡ç‚¹è¿æ¥**æµé‡ä¸ºæƒå€¼ç›¸åæ•°çš„è¾¹**ï¼›åŸå›¾ä¸­çš„è¾¹æµé‡è®¾ç½®ä¸º $\infty$ ã€‚ç„¶åè·‘ä¸€éæœ€å¤§æµå³å¯ï¼Œç­”æ¡ˆå³ä¸º**æ­£æƒå€¼ä¹‹å’Œå‡å»æœ€å¤§æµ**ã€‚

ä¸‹é¢ç»™å‡º**éä¸¥è°¨è¯æ˜**ï¼š 

>1. æ¯ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„å­å›¾éƒ½å¯¹åº”æµé‡ç½‘ç»œä¸­çš„ä¸€ä¸ªå‰²ã€‚å› ä¸ºæ¯ä¸€ä¸ªå‰²å°†ç½‘ç»œåˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œä¸ $s$ ç›¸è¿çš„é‚£éƒ¨åˆ†æ»¡è¶³æ²¡æœ‰è¾¹æŒ‡å‘å¦ä¸€éƒ¨åˆ†ï¼Œäºæ˜¯æ»¡è¶³ä¸Šè¿°æ¡ä»¶ã€‚è¿™ä¸ªå‘½é¢˜æ˜¯å……è¦çš„ã€‚
>2. æœ€å°å‰²æ‰€å»é™¤çš„è¾¹å¿…é¡»ä¸ $s$ å’Œ $t$ å…¶ä¸­ä¸€è€…ç›¸è¿ã€‚å› ä¸ºå¦åˆ™è¾¹æƒæ˜¯ $\infty$ï¼Œä¸å¯èƒ½æˆä¸ºæœ€å°å‰²ã€‚
>3. æˆ‘ä»¬æ‰€é€‰æ‹©çš„é‚£éƒ¨åˆ†å­å›¾ï¼Œæƒå€¼å’Œ $=$ æ‰€æœ‰æ­£æƒå€¼ä¹‹å’Œ $-$ æˆ‘ä»¬æœªé€‰æ‹©çš„æ­£æƒå€¼ç‚¹çš„æƒå€¼ä¹‹å’Œ $+$ æˆ‘ä»¬é€‰æ‹©çš„è´Ÿæƒå€¼ç‚¹çš„æƒå€¼ä¹‹å’Œã€‚å½“æˆ‘ä»¬ä¸é€‰æ‹©ä¸€ä¸ªæ­£æƒå€¼ç‚¹æ—¶ï¼Œå…¶ä¸ $s$ çš„è¿è¾¹ä¼šè¢«æ–­å¼€ï¼›å½“æˆ‘ä»¬é€‰æ‹©ä¸€ä¸ªè´Ÿæƒå€¼ç‚¹æ—¶ï¼Œå…¶ä¸ $t$ çš„è¿è¾¹ä¼šè¢«æ–­å¼€ã€‚æ–­å¼€çš„è¾¹çš„è¾¹æƒä¹‹å’Œå³ä¸ºå‰²çš„å®¹é‡ã€‚äºæ˜¯ä¸Šè¿°å¼å­è½¬åŒ–ä¸ºï¼šæƒå€¼å’Œ $=$ æ‰€æœ‰æ­£æƒå€¼ä¹‹å’Œ $-$ å‰²çš„å®¹é‡ã€‚
>4. äºæ˜¯å¾—å‡ºç»“è®ºï¼Œæœ€å¤§æƒå€¼å’Œ $=$ æ‰€æœ‰æ­£æƒå€¼ä¹‹å’Œ $-$ æœ€å°å‰² $=$ æ‰€æœ‰æ­£æƒå€¼ä¹‹å’Œ $-$ æœ€å¤§æµã€‚



## 13ã€[èˆªç©ºè·¯çº¿é—®é¢˜ ](https://www.luogu.com.cn/problem/P2770)

>**ç»™å®šä¸€å¼ èˆªç©ºå›¾ï¼Œå›¾ä¸­é¡¶ç‚¹ä»£è¡¨åŸå¸‚ï¼Œè¾¹ä»£è¡¨ä¸¤åŸå¸‚é—´çš„ç›´é€šèˆªçº¿ï¼Œå¹¶ä¸”ä¸å­˜åœ¨ä»»ä½•ä¸¤ä¸ªåŸå¸‚åœ¨åŒä¸€æ¡ç»çº¿ä¸Šã€‚ç°è¦æ±‚æ‰¾å‡ºä¸€æ¡æ»¡è¶³ä¸‹è¿°é™åˆ¶æ¡ä»¶çš„ä¸”é€”ç»åŸå¸‚æœ€å¤šçš„æ—…è¡Œè·¯çº¿ã€‚**
>
>1. **ä»æœ€è¥¿ç«¯åŸå¸‚å‡ºå‘ï¼Œå•å‘ä»è¥¿å‘ä¸œé€”ç»è‹¥å¹²åŸå¸‚åˆ°è¾¾æœ€ä¸œç«¯åŸå¸‚ï¼Œç„¶åå†å•å‘ä»ä¸œå‘è¥¿é£å›èµ·ç‚¹ï¼ˆå¯é€”ç»è‹¥å¹²åŸå¸‚ï¼‰ã€‚**
>
>2. **é™¤èµ·ç‚¹åŸå¸‚å¤–ï¼Œä»»ä½•åŸå¸‚åªèƒ½è®¿é—®ä¸€æ¬¡ã€‚**
>
>**å¯¹äºç»™å®šçš„èˆªç©ºå›¾ï¼Œè¯•è®¾è®¡ä¸€ä¸ªç®—æ³•æ‰¾å‡ºä¸€æ¡æ»¡è¶³è¦æ±‚çš„æœ€ä½³èˆªç©ºæ—…è¡Œè·¯çº¿ã€‚**

å¯¹äºç‚¹ä¸Šçš„é™åˆ¶ï¼Œä¸€èˆ¬è€ƒè™‘å°†ä¸€ä¸ªç‚¹**æ‹†æˆä¸¤ä¸ªç‚¹** $i$ å’Œ $i+n$ï¼Œç„¶åèŠ‚ç‚¹çš„å…¥è¾¹å¯¹ $i$ å»ºè¾¹ï¼Œå‡ºè¾¹å¯¹ $i+n$ å»ºè¾¹ï¼Œå†åœ¨ $i$ å’Œ $i+n$ ä¹‹é—´å»ºè¾¹ï¼Œå¹¶æ“ä½œè¯¥è¾¹ä»¥æ»¡è¶³å¯¹äºè¯¥ç‚¹çš„é™åˆ¶ï¼ˆä¸ºæ–¹ä¾¿ï¼Œä¸‹ç§°ä¹‹ä¸º**æ‹†ç‚¹å†…éƒ¨è¾¹**ï¼‰ã€‚
å¯¹äºè¿™é“é¢˜ç›®ï¼Œå› ä¸ºæ¯ä¸ªç‚¹éƒ½åªèƒ½é€šè¿‡ä¸€æ¬¡ï¼Œæˆ‘ä»¬å°†æ‹†ç‚¹å†…éƒ¨è¾¹çš„æµé‡è®¾ç½®ä¸º $1$ (é™¤äº†é¦–å°¾ä¸¤ä¸ªèŠ‚ç‚¹)ã€‚é¢˜ç›®è¦æ±‚æ¥å›ä¸€æ¬¡ï¼Œå› ä¸º**é¦–åˆ°å°¾ä¸å°¾åˆ°é¦–ç­‰æ•ˆ**ï¼Œè¯¥æ“ä½œå¯ä»¥ç­‰æ•ˆä¸ºä»è¥¿ç«¯åŸå¸‚å‡ºå‘ä¸¤æ¬¡ï¼Œä¸¤æ¬¡æ—…è¡Œè·¯çº¿éƒ½ä¸é‡å¤ï¼Œåˆ°è¾¾æœ€ä¸œç«¯åŸå¸‚çš„æœ€ä½³è·¯çº¿ã€‚é‚£ä¹ˆç›´æ¥å°† $1$ ä¸ $s$ å»ºç«‹ä¸€æ¡æµé‡ä¸º $2$ çš„è¾¹ï¼Œå°† $2*n$ ä¸ $t$ å»ºç«‹ä¸€æ¡æµé‡ä¸º $2$ çš„è¾¹ï¼Œè·‘ä¸€éè´¹ç”¨æµå³å¯ã€‚



## 14ã€[æ·±æµ·æœºå™¨äººé—®é¢˜](https://www.luogu.com.cn/problem/P4012)

>**æ·±æµ·èµ„æºè€ƒå¯Ÿæ¢é™©é˜Ÿçš„æ½œè‰‡å°†åˆ°è¾¾æ·±æµ·çš„æµ·åº•è¿›è¡Œç§‘å­¦è€ƒå¯Ÿã€‚**
>**æ½œè‰‡å†…æœ‰å¤šä¸ªæ·±æµ·æœºå™¨äººã€‚æ½œè‰‡åˆ°è¾¾æ·±æµ·æµ·åº•åï¼Œæ·±æµ·æœºå™¨äººå°†ç¦»å¼€æ½œè‰‡å‘é¢„å®šç›®æ ‡ç§»åŠ¨ã€‚**
>**æ·±æµ·æœºå™¨äººåœ¨ç§»åŠ¨ä¸­è¿˜å¿…é¡»æ²¿é€”é‡‡é›†æµ·åº•ç”Ÿç‰©æ ‡æœ¬ã€‚æ²¿é€”ç”Ÿç‰©æ ‡æœ¬ç”±æœ€å…ˆé‡åˆ°å®ƒçš„æ·±æµ·æœºå™¨äººå®Œæˆé‡‡é›†ã€‚**
>**æ¯æ¡é¢„å®šè·¯å¾„ä¸Šçš„ç”Ÿç‰©æ ‡æœ¬çš„ä»·å€¼æ˜¯å·²çŸ¥çš„ï¼Œè€Œä¸”ç”Ÿç‰©æ ‡æœ¬åªèƒ½è¢«é‡‡é›†ä¸€æ¬¡ã€‚**
>**æœ¬é¢˜é™å®šæ·±æµ·æœºå™¨äººåªèƒ½ä»å…¶å‡ºå‘ä½ç½®æ²¿ç€å‘åŒ—æˆ–å‘ä¸œçš„æ–¹å‘ç§»åŠ¨ï¼Œè€Œä¸”å¤šä¸ªæ·±æµ·æœºå™¨äººå¯ä»¥åœ¨åŒä¸€æ—¶é—´å æ®åŒä¸€ä½ç½®ã€‚**
>**ç”¨ä¸€ä¸ª $P\times Q$ ç½‘æ ¼è¡¨ç¤ºæ·±æµ·æœºå™¨äººçš„å¯ç§»åŠ¨ä½ç½®ã€‚è¥¿å—è§’çš„åæ ‡ä¸º $(0,0)$ï¼Œä¸œåŒ—è§’çš„åæ ‡ä¸º $(Q,P)$ ã€‚**
>
>**![](https://cdn.luogu.com.cn/upload/pic/12215.png)** 
>
>**ç»™å®šæ¯ä¸ªæ·±æµ·æœºå™¨äººçš„å‡ºå‘ä½ç½®å’Œç›®æ ‡ä½ç½®ï¼Œä»¥åŠæ¯æ¡ç½‘æ ¼è¾¹ä¸Šç”Ÿç‰©æ ‡æœ¬çš„ä»·å€¼ã€‚**
>**è®¡ç®—æ·±æµ·æœºå™¨äººçš„æœ€ä¼˜ç§»åŠ¨æ–¹æ¡ˆï¼Œ ä½¿æ·±æµ·æœºå™¨äººåˆ°è¾¾ç›®çš„åœ°åï¼Œé‡‡é›†åˆ°çš„ç”Ÿç‰©æ ‡æœ¬çš„æ€»ä»·å€¼æœ€é«˜ã€‚**



## 33ã€[å¿—æ„¿è€…æ‹›å‹Ÿ](https://www.luogu.com.cn/problem/P3980)

>**ç”³å¥¥æˆåŠŸåï¼Œå¸ƒå¸ƒç»è¿‡ä¸æ‡ˆåŠªåŠ›ï¼Œç»ˆäºæˆä¸ºå¥¥ç»„å§”ä¸‹å±å…¬å¸äººåŠ›èµ„æºéƒ¨é—¨çš„ä¸»ç®¡ã€‚å¸ƒå¸ƒåˆšä¸Šä»»å°±é‡åˆ°äº†ä¸€ä¸ªéš¾é¢˜ï¼šä¸ºå³å°†å¯åŠ¨çš„å¥¥è¿æ–°é¡¹ç›®æ‹›å‹Ÿä¸€æ‰¹çŸ­æœŸå¿—æ„¿è€…ã€‚ç»è¿‡ä¼°ç®—ï¼Œè¿™ä¸ªé¡¹ç›®éœ€è¦ $n$ å¤©æ‰èƒ½å®Œæˆï¼Œå…¶ä¸­ç¬¬ $i$ å¤©è‡³å°‘éœ€è¦ $a_i$ ä¸ªäººã€‚å¸ƒå¸ƒé€šè¿‡äº†è§£å¾—çŸ¥ï¼Œä¸€å…±æœ‰ $m$ ç±»å¿—æ„¿è€…å¯ä»¥æ‹›å‹Ÿã€‚å…¶ä¸­ç¬¬ $i$ ç±»å¯ä»¥ä»ç¬¬ $s_i$ å¤©å·¥ä½œåˆ°ç¬¬ $t_i$ å¤©ï¼Œæ‹›å‹Ÿè´¹ç”¨æ˜¯æ¯äºº $c_i$ å…ƒã€‚æ–°å®˜ä¸Šä»»ä¸‰æŠŠç«ï¼Œä¸ºäº†å‡ºè‰²åœ°å®Œæˆè‡ªå·±çš„å·¥ä½œï¼Œå¸ƒå¸ƒå¸Œæœ›ç”¨å°½é‡å°‘çš„è´¹ç”¨æ‹›å‹Ÿè¶³å¤Ÿçš„å¿—æ„¿è€…ï¼Œä½†è¿™å¹¶ä¸æ˜¯ä»–çš„ç‰¹é•¿ï¼äºæ˜¯å¸ƒå¸ƒæ‰¾åˆ°äº†ä½ ï¼Œå¸Œæœ›ä½ å¸®ä»–è®¾è®¡ä¸€ç§æœ€ä¼˜çš„æ‹›å‹Ÿæ–¹æ¡ˆã€‚**

è¿™é“é¢˜å»ºæ¨¡çš„éš¾ç‚¹åœ¨äºï¼šæ¯ä¸ªäººä¸€æ¬¡åªèƒ½å¹²ä¸€ä¸ªè¿ç»­çš„æ—¶é—´ï¼Œä¹Ÿå°±ç›¸å½“äº**ä¸€ä¸ªé›†åˆçš„å…ƒç´ å’Œå¦ä¸€ä¸ªé›†åˆçš„å…ƒç´ åŒºé—´å¯¹åº”**ã€‚å› æ­¤ï¼Œç›´æ¥é€šè¿‡å°†äººå¯¹å¤©æ•°å»ºè¾¹æ˜¯ä¸ç°å®çš„ã€‚
å®¹æ˜“æƒ³åˆ°ï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥ä½¿ç”¨**è´Ÿæµ**çš„è¯ï¼Œåªéœ€è¦å°†æ¯å¤©éƒ½å‘ä¸‹ä¸€å¤©å»ºç«‹ä¸€æ¡æµé‡ä¸º $-a[i]$ï¼Œæƒå€¼ä¸º $0$ çš„è¾¹ï¼Œç„¶åå†åœ¨ç¬¬ $s[i]$ å¤©åˆ°ç¬¬ $t[i]$ å¤©å»ºç«‹ä¸€æ¡æµé‡ä¸º $INF$ï¼Œæƒå€¼ä¸º $c[i]$ çš„è¾¹ï¼Œç„¶ååœ¨å†å…¶ä¸Šè·‘**è´¹ç”¨æµ**å³å¯ã€‚ä½†æ˜¯æ²¡æœ‰åŠæ³•å»ºç«‹è´Ÿè¾¹ï¼Œæˆ‘ä»¬å¾—è€ƒè™‘ä½¿ç”¨ä¸€ç§ç­‰ä»·çš„æ–¹å¼æ¥æ›¿ä»£è´Ÿè¾¹çš„å»ºç«‹ã€‚å› ä¸ºè´¹ç”¨æµæ˜¯**æµé‡æœ€å¤§**æ—¶å€™çš„**æœ€å°è´¹ç”¨**æµï¼Œå› æ­¤ï¼Œæˆ‘ä»¬æ„é€ å›¾ä½¿å¾—è¯¥å›¾çš„**æœ€å¤§æµæ˜¯ä¸€ä¸ªå¤§å€¼**ï¼Œç„¶åå†å°†å¤©ä¹‹é—´çš„èŠ‚ç‚¹çš„æµé‡è®¾ç½®ä¸º $INF-a[i]$ï¼Œè¿™æ ·å­ä¸ºäº†ä¿è¯æœ€ç»ˆæµé‡æ˜¯æœ€å¤§æµï¼Œé‚£ä¹ˆå¿—æ„¿è€…è¾¹å°±å¿…é¡»å‘åŠ›ï¼ˆé›¾ï¼‰æ¥**å¼¥è¡¥åœ¨å¤©æ•°ä¸¢å¤±çš„æµé‡**ï¼Œä»¥è¾¾åˆ°è´Ÿè¾¹éœ€è¦å…¶ä»–åœ°æ–¹åŒ€æµé‡çš„æ€§è´¨ã€‚å»ºå›¾åè·‘ä¸€è¾¹è´¹ç”¨æµå³å¯ã€‚

























